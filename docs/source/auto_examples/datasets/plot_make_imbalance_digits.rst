
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples\datasets\plot_make_imbalance_digits.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_datasets_plot_make_imbalance_digits.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_datasets_plot_make_imbalance_digits.py:


=========================================================
Make digits dataset class-imbalanced
=========================================================

An illustration of the :func:`~imbalanced_ensemble.datasets.make_imbalance` 
function to create an imbalanced version of the digits dataset.

.. GENERATED FROM PYTHON SOURCE LINES 9-13

.. code-block:: default


    # Authors: Zhining Liu <zhining.liu@outlook.com>
    # License: MIT








.. GENERATED FROM PYTHON SOURCE LINES 14-30

.. code-block:: default

    print(__doc__)

    # Import imbalanced_ensemble
    import imbalanced_ensemble as imbens

    # Import utilities
    import sklearn
    from imbalanced_ensemble.datasets import make_imbalance
    from imbalanced_ensemble.utils._plot import plot_2Dprojection_and_cardinality, plot_scatter
    import matplotlib.pyplot as plt
    import seaborn as sns

    RANDOM_STATE = 42

    # sphinx_gallery_thumbnail_number = -1








.. GENERATED FROM PYTHON SOURCE LINES 31-34

Digits dataset
--------------
The digits dataset consists of 8x8 pixel images of digits. The images attribute of the dataset stores 8x8 arrays of grayscale values for each image. We will use these arrays to visualize the first 4 images. The target attribute of the dataset stores the digit each image represents and this is included in the title of the 4 plots below.

.. GENERATED FROM PYTHON SOURCE LINES 34-48

.. code-block:: default


    digits = sklearn.datasets.load_digits()

    # flatten the images
    n_samples = len(digits.images)
    X, y = digits.images.reshape((n_samples, -1)), digits.target

    _, axes = plt.subplots(nrows=3, ncols=4, figsize=(10, 9))
    for ax, image, label in zip(axes.flatten(), digits.images, digits.target):
        ax.set_axis_off()
        ax.imshow(image, cmap=plt.cm.gray_r, interpolation='nearest')
        ax.set_title('Training: %i' % label)





.. image:: /auto_examples/datasets/images/sphx_glr_plot_make_imbalance_digits_001.png
    :alt: Training: 0, Training: 1, Training: 2, Training: 3, Training: 4, Training: 5, Training: 6, Training: 7, Training: 8, Training: 9, Training: 0, Training: 1
    :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 49-50

**The original digits dataset**

.. GENERATED FROM PYTHON SOURCE LINES 50-54

.. code-block:: default


    fig = plot_2Dprojection_and_cardinality(X, y, figsize=(8, 4))





.. image:: /auto_examples/datasets/images/sphx_glr_plot_make_imbalance_digits_002.png
    :alt: Dataset (2D projection by KernelPCA), Class Distribution
    :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 55-56

**Make class-imbalanced digits dataset**

.. GENERATED FROM PYTHON SOURCE LINES 56-64

.. code-block:: default


    imbalance_distr = {0: 178, 1: 120, 2: 80, 3: 60, 4: 50, 5: 44, 6: 40, 7: 40, 8: 40, 9: 40}

    X_imb, y_imb = make_imbalance(X, y, sampling_strategy=imbalance_distr, random_state=RANDOM_STATE)

    fig = plot_2Dprojection_and_cardinality(X_imb, y_imb, figsize=(8, 4))





.. image:: /auto_examples/datasets/images/sphx_glr_plot_make_imbalance_digits_003.png
    :alt: Dataset (2D projection by KernelPCA), Class Distribution
    :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 65-69

Use TSNE to compare the original & imbalanced Digits datasets
-------------------------------------------------------------
We can observe that it is more difficult to distinguish the tail classes from each other in the imbalanced Digits dataset.  
These tailed classes are not well represented, thus it is harder for a learning model to learn their patterns.

.. GENERATED FROM PYTHON SOURCE LINES 69-89

.. code-block:: default


    sns.set_context('talk')

    tsne = sklearn.manifold.TSNE(n_components=2, perplexity=100, n_iter=500, random_state=RANDOM_STATE)

    fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 6))

    # Plot original digits data
    plot_scatter(tsne.fit_transform(X), y, title='Original Digits Data', weights=100, 
                 vis_params={'edgecolor': 'black', 'alpha': 0.8}, ax=ax1)
    ax1.legend(ncol=2, loc=2, columnspacing=0.01, borderaxespad=0.1, handletextpad=0.01, 
               labelspacing=0.01, handlelength=None)

    # Plot imbalanced digits data
    plot_scatter(tsne.fit_transform(X_imb), y_imb, title='Imbalanced Digits Data', weights=100, 
                 vis_params={'edgecolor': 'black', 'alpha': 0.8}, ax=ax2)
    ax2.legend(ncol=2, loc=2, columnspacing=0.01, borderaxespad=0.1, handletextpad=0.01, 
               labelspacing=0.01, handlelength=None)

    fig.tight_layout()



.. image:: /auto_examples/datasets/images/sphx_glr_plot_make_imbalance_digits_004.png
    :alt: Original Digits Data, Imbalanced Digits Data
    :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  42.552 seconds)

**Estimated memory usage:**  46 MB


.. _sphx_glr_download_auto_examples_datasets_plot_make_imbalance_digits.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_make_imbalance_digits.py <plot_make_imbalance_digits.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_make_imbalance_digits.ipynb <plot_make_imbalance_digits.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
